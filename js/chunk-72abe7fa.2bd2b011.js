(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-72abe7fa"],{"08b9":function(t,e,s){"use strict";s("13de")},"13de":function(t,e,s){},"7cb4":function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("Header"),s("div",{staticClass:"container"},[s("div",{staticClass:"h1 text-light text-center mt-5 mb-4"},[t._v("HOLO商城 結帳")]),s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-10 col-md-4 mt-3"},[s("div",{staticClass:"bg-transparent rounded-pill text-center fs-5 mx-auto py-2",class:{"progress--active":1===t.step,"progress--inactive":!(1===t.step)}},[t._v(" 1.輸入訂單資料 ")])]),s("div",{staticClass:"col-10 col-md-4 mt-3"},[s("div",{staticClass:"bg-transparent rounded-pill text-center fs-5 mx-auto py-2",class:{"progress--active":2===t.step,"progress--inactive":!(2===t.step)}},[t._v(" 2.確認結帳 ")])]),s("div",{staticClass:"col-10 col-md-4 mt-3"},[s("div",{staticClass:"bg-transparent rounded-pill text-center fs-5 mx-auto py-2",class:{"progress--active":3===t.step,"progress--inactive":!(3===t.step)}},[t._v(" 3.結帳完成 ")])])]),s("InformationForm",{directives:[{name:"show",rawName:"v-show",value:1===t.step,expression:"step === 1"}],on:{"update-form":t.updateForm}}),s("div",{directives:[{name:"show",rawName:"v-show",value:2===t.step,expression:"step === 2"}],staticClass:"row justify-content-center mb-5 mt-5"},[s("div",{staticClass:"col-lg-7 col-md-9 col-10 h2 text-light text-center mb-4 cartList__title--bgcolor py-2"},[t._v(" 購物車資訊 "),t.showCartSpinner?s("span",{staticClass:"spinner-border spinner-border-sm",staticStyle:{width:"1.7rem",height:"1.7rem"},attrs:{role:"status","aria-hidden":"true"}}):t._e()]),s("div",{staticClass:"table-responsive col-lg-7 col-md-9"},[s("table",{staticClass:"table text-light"},[t._m(0),s("tbody",[t._l(t.cartArray,(function(e,r){return s("tr",{key:e.id},[s("td",{staticClass:"text-center align-middle"},[s("button",{staticClass:"btn btn-outline-danger btn-sm",attrs:{type:"button"},on:{click:function(s){return s.preventDefault(),t.delFromCart(e.id,r)}}},[s("font-awesome-icon",{attrs:{icon:"trash-alt"}})],1)]),s("td",{staticClass:"cartList-cart-bgimg me-3",style:{"background-image":"url("+e.product.imageUrl+")"}}),s("td",{staticClass:"py-4 align-middle"},[s("p",{staticClass:"mb-1 text-center"},[t._v(t._s(e.product.title))]),t.cartDiscountPrice?s("p",{staticClass:"mb-0 text-success text-center"},[t._v("已套用折價卷")]):t._e()]),s("td",{staticClass:"py-4 text-center align-middle"},[t._v(t._s(e.qty)+" "+t._s(e.product.unit))]),s("td",{staticClass:"py-4 text-end align-middle"},[t._v(t._s(t._f("currencyFilter")(e.product.price)))])])})),s("tr",[s("td"),s("td"),s("td"),s("td",{staticClass:"text-end align-middle"},[t._v("總計")]),s("td",{staticClass:"text-end fs-5 align-middle text-danger",class:{"text-decoration-line-through":!!t.cartDiscountPrice&&t.cartDiscountPrice!==t.cartTotalPrice()}},[t._v(" "+t._s(t._f("currencyFilter")(t.cartTotalPrice()))+" ")])]),t.cartDiscountPrice&&t.cartDiscountPrice!==t.cartTotalPrice()?s("tr",{staticClass:"text-success"},[s("td",{staticClass:"border-bottom-0"}),s("td",{staticClass:"border-bottom-0"}),s("td",{staticClass:"border-bottom-0"}),s("td",{staticClass:"text-end border-bottom-0 align-middle"},[t._v("折扣價")]),s("td",{staticClass:"text-end border-bottom-0 fs-5 align-middle"},[t._v(t._s(t._f("currencyFilter")(t.cartDiscountPrice)))])]):t._e()],2)]),s("div",{staticClass:"input-group w-75 mt-2 mx-auto"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.couponCode,expression:"couponCode"}],staticClass:"form-control bg-transparent text-light border-warning border-end-0",attrs:{type:"text",placeholder:"請輸入優惠碼","aria-label":"Coupon Code","aria-describedby":"coupon-code"},domProps:{value:t.couponCode},on:{input:function(e){e.target.composing||(t.couponCode=e.target.value)}}}),s("button",{staticClass:"btn btn-outline-warning",on:{click:function(e){return t.applyCoupon()}}},[t._v("套用優惠碼")])]),s("div",{staticClass:"text-end fs-6 mt-3"},[s("button",{staticClass:"btn btn-outline-warning me-3",on:{click:function(e){t.step-=1}}},[t._v("上一步")]),s("button",{staticClass:"btn btn-outline-danger",class:{disabled:!t.cartArray.length},on:{click:t.placeOrder}},[t._v(" 確認並付款 "),t.showPaySpinner?s("span",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status","aria-hidden":"true"}}):t._e()])])])]),3===t.step?s("div",{staticClass:"my-5 row justify-content-center"},[s("div",{staticClass:"col-lg-7 col-md-9 col-10"},[s("table",{staticClass:"table text-light"},[t._m(1),s("tbody",t._l(t.order.products,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"align-middle"},[t._v(t._s(e.product.title))]),s("td",{staticClass:"align-middle"},[t._v(t._s(e.qty)+" / "+t._s(e.product.unit))]),s("td",{staticClass:"align-middle text-end"},[t._v(t._s(e.final_total))])])})),0),s("tfoot",[s("tr",[s("td",{staticClass:"text-end",attrs:{colspan:"2"}},[t._v("總計")]),s("td",{staticClass:"text-end text-danger"},[t._v(t._s(t.order.total))])])])]),s("table",{staticClass:"table text-light mt-5"},[s("tbody",[s("tr",[s("th",[t._v("Email")]),s("td",[t._v(t._s(t.order.user.email))])]),s("tr",[s("th",[t._v("姓名")]),s("td",[t._v(t._s(t.order.user.name))])]),s("tr",[s("th",[t._v("收件人電話")]),s("td",[t._v(t._s(t.order.user.tel))])]),s("tr",[s("th",[t._v("收件人地址")]),s("td",[t._v(t._s(t.order.user.address))])]),s("tr",[s("th",[t._v("付款狀態")]),s("td",[t.order.is_paid?s("span",{staticClass:"text-success"},[t._v("付款完成")]):s("span",{staticClass:"text-danger"},[t._v("尚未付款")])])])])]),s("div",{staticClass:"text-end fs-6 mb-2"},[s("button",{staticClass:"btn btn-outline-warning me-3",on:{click:function(e){return t.$router.push({name:"Products",query:{category:"cloth"}})}}},[t._v(" 繼續選購 ")])])])]):t._e()],1),s("Footer")],1)},a=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",{staticClass:"border-top border-light",attrs:{scope:"col"}}),s("th",{staticClass:"border-top border-light",attrs:{scope:"col"}}),s("th",{staticClass:"border-top border-light text-center",attrs:{scope:"col"}},[t._v("品名")]),s("th",{staticClass:"border-top border-light text-center",attrs:{scope:"col"}},[t._v("數量")]),s("th",{staticClass:"border-top border-light text-center cartList__price",attrs:{scope:"col"}},[t._v("單價")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",{attrs:{scope:"col"}},[t._v("品名")]),s("th",{attrs:{scope:"col"}},[t._v("數量")]),s("th",{staticClass:"price-width",attrs:{scope:"col"}},[t._v("單價")])])])}],o=s("5530"),i=(s("159b"),s("2f62")),n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ValidationObserver",{scopedSlots:t._u([{key:"default",fn:function(e){var r=e.handleSubmit;return[s("div",{staticClass:"row justify-content-center text-light"},[s("form",{staticClass:"col-lg-7 col-md-9 col-10",attrs:{novalidate:""},on:{submit:function(e){return e.preventDefault(),r(t.submitForm)}}},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-12 h2 text-light text-center personalInformation__title--bgcolor mt-5 mb-4 py-2"},[t._v("訂購人資訊")]),s("div",{staticClass:"col-12"},[s("ValidationProvider",{attrs:{name:"email",rules:"required|email"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.errors,a=e.classes;return[s("label",{staticClass:"fs-6 mb-2",attrs:{for:"userEmail"}},[t._v("電子信箱")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.email,expression:"form.user.email"}],staticClass:"form-control bg-transparent text-light",class:a,attrs:{type:"email",name:"email",id:"userEmail",placeholder:"請輸入 Email",required:""},domProps:{value:t.form.user.email},on:{input:function(e){e.target.composing||t.$set(t.form.user,"email",e.target.value)}}}),s("p",{staticClass:"text-danger fw-bold mt-1 mb-1"},[t._v(t._s(r[0]))])]}}],null,!0)})],1)]),s("div",{staticClass:"row mt-2"},[s("div",{staticClass:"col-12"},[s("ValidationProvider",{attrs:{name:"userName",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.errors,a=e.classes;return[s("label",{staticClass:"fs-6 mb-2",attrs:{for:"userName"}},[t._v("收件人姓名")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.name,expression:"form.user.name"}],staticClass:"form-control bg-transparent text-light",class:a,attrs:{type:"text",name:"userName",id:"userName",placeholder:"輸入姓名"},domProps:{value:t.form.user.name},on:{input:function(e){e.target.composing||t.$set(t.form.user,"name",e.target.value)}}}),s("p",{staticClass:"text-danger fw-bold mt-1 mb-1"},[t._v(t._s(r[0]))])]}}],null,!0)})],1)]),s("div",{staticClass:"row mt-2"},[s("div",{staticClass:"col-12"},[s("ValidationProvider",{attrs:{name:"userTel",rules:"required|digits:10"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.errors,a=e.classes;return[s("label",{staticClass:"fs-6 mb-2",attrs:{for:"userTel"}},[t._v("收件人電話")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.tel,expression:"form.user.tel"}],staticClass:"form-control bg-transparent text-light",class:a,attrs:{type:"text",id:"userTel",placeholder:"請輸入電話"},domProps:{value:t.form.user.tel},on:{input:function(e){e.target.composing||t.$set(t.form.user,"tel",e.target.value)}}}),s("p",{staticClass:"text-danger fw-bold mt-1 mb-1"},[t._v(t._s(r[0]))])]}}],null,!0)})],1)]),s("div",{staticClass:"row mt-2"},[s("div",{staticClass:"col-12"},[s("ValidationProvider",{attrs:{name:"userAddress",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.errors,a=e.classes;return[s("label",{staticClass:"fs-6 mb-2",attrs:{for:"userAddress"}},[t._v("收件人地址")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.address,expression:"form.user.address"}],staticClass:"form-control bg-transparent text-light",class:a,attrs:{type:"text",name:"address",id:"userAddress",placeholder:"請輸入地址"},domProps:{value:t.form.user.address},on:{input:function(e){e.target.composing||t.$set(t.form.user,"address",e.target.value)}}}),s("p",{staticClass:"text-danger fw-bold mt-1 mb-1"},[t._v(t._s(r[0]))])]}}],null,!0)})],1)]),s("div",{staticClass:"row mt-2 mb-3"},[s("div",{staticClass:"col-12"},[s("label",{staticClass:"fs-6 mb-2",attrs:{for:"comment"}},[t._v("備註")]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.message,expression:"form.message"}],staticClass:"form-control bg-transparent text-light",attrs:{name:"comment",id:"comment",rows:"6"},domProps:{value:t.form.message},on:{input:function(e){e.target.composing||t.$set(t.form,"message",e.target.value)}}})])]),s("div",{staticClass:"text-end fs-6 mb-2"},[s("button",{staticClass:"btn btn-outline-warning",attrs:{type:"submit"}},[t._v("下一步")])])])])]}}])})},l=[],c=s("7bb1"),d={name:"InformationForm",components:{ValidationProvider:c["b"],ValidationObserver:c["a"]},data:function(){return{form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{submitForm:function(){this.$emit("update-form",this.form)}}},u=d,m=(s("08b9"),s("2877")),p=Object(m["a"])(u,n,l,!1,null,"9038c780",null),v=p.exports,f=s("0418"),b=s("fd2d"),C=s("fd40"),g=s("bb36"),_={post:function(t){return g["a"].post("/coupon",{data:{code:t}})}},h={get:function(t){return g["a"].get("/order/".concat(t))},postOrder:function(t){return g["a"].post("/order",{data:t})},postPayment:function(t){return g["a"].post("/pay/".concat(t))}},x={data:function(){return{form:{},couponCode:"",cartDiscountPrice:0,step:1,order:{user:{}},orderId:"",showCartSpinner:!1,showPaySpinner:!1}},components:{InformationForm:v,Header:f["a"],Footer:b["a"]},computed:Object(o["a"])(Object(o["a"])({},Object(i["c"])(["cartArray"])),Object(i["b"])(["cartTotalPrice"])),methods:{updateForm:function(t){this.form=t,this.step+=1},delFromCart:function(t,e){var s=this;this.showCartSpinner=!0,C["a"].delete(t).then((function(){s.$store.commit("delFromCart",e),s.cartArray.forEach((function(t){console.log(t)})),s.showCartSpinner=!1}))},applyCoupon:function(){var t=this;this.showCartSpinner=!0,_.post(this.couponCode).then((function(e){e.data.success?(console.log(e),t.cartDiscountPrice=e.data.data.final_total,t.couponCode="",t.showCartSpinner=!1):(console.log(e.data.message),t.couponCode="",t.showCartSpinner=!1)}))},getOrder:function(){var t=this;h.get(this.orderId).then((function(e){t.order=e.data.order}))},placeOrder:function(){var t=this;this.showPaySpinner=!0,h.postOrder(this.form).then((function(e){e.data.success?(t.form={},t.orderId=e.data.orderId,t.getOrder(),h.postPayment(t.orderId).then((function(){t.order.is_paid=!0,t.step+=1,t.showPaySpinner=!1,t.$store.commit("updateCartArray",[])}))):t.showPaySpinner=!1}))}}},y=x,w=Object(m["a"])(y,r,a,!1,null,null,null);e["default"]=w.exports}}]);
//# sourceMappingURL=chunk-72abe7fa.2bd2b011.js.map